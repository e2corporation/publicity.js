/*! Publicity 2015-06-03 */
!function(a,b,c,d,e){var f={API:{endpoint:"https://trends.revcontent.com/api/v1/?",api_key:"fdbd849fb2b8c1c259585e7bcd6a09cc87e3e5b7",pub_id:10,widget_id:21,type:"json",domain:"powr.com"}},g={ReactCSSTransitionGroup:d.addons.CSSTransitionGroup,stack:[],foo:[],options:{cardClass:"publicity-card",gridClass:"publicity-arrangement"},internal_count:1,internal_offset:1,sponsored_count:1,sponsored_offset:1,init:function(){g.createComponents(),a.each(a(".publicity-card"),function(a,b){g.buildCard(b)}),g.buildArrangement(c.getElementById("example_grid")),g.buildArrangement(c.getElementById("example_grid_1x2")),g.configureCards()},fetchCard:function(b,c,d,e,h,i){if(b)var j=b;else var j=a(".card:first");c||(c=parseInt(j.attr("data-offset"))),d||(d=parseInt(j.attr("data-count"))),e||(e=parseInt(j.attr("data-sp-offset"))),h||(h=parseInt(j.attr("data-sp-count"))),g.internal_count=c||1,g.internal_offset++,g.sponsored_count=h||1,g.sponsored_offset++;a.ajax({url:f.API.endpoint,type:"get",dataType:f.API.type,cache:!1,data:{api_key:f.API.api_key,pub_id:f.API.pub_id,widget_id:f.API.widget_id,type:f.API.type,domain:f.API.domain,sponsored_count:g.sponsored_count,sponsored_offset:g.sponsored_offset},beforeSend:function(){g.activateLoader(j)},success:function(b){return b.length>0&&(g.stack.push(b[0]),"object"==typeof i&&i.isMounted()&&(i.setState({data:g.stack.shift(),internal_count:g.internal_count,internal_offset:g.internal_offset,sponsored_count:g.sponsored_count,sponsored_offset:g.sponsored_offset}),g.deactivateLoader(a(i.getDOMNode())))),b.length>0?b:void 0},error:function(a){}})},showDismissal:function(b){b.find(".dismissal").animate({"margin-top":0},700,"easeOutQuart",function(){a(this).addClass("on").removeClass("off")})},hideDismissal:function(b){b.find(".dismissal").animate({"margin-top":"-600px"},700,"easeInQuart",function(){a(this).removeClass("on").addClass("off")})},activateLoader:function(b){return b.find(".overlay").css({backgroundColor:"rgba(0,0,0,0.9)"}),b.find(".loader").animate({top:0,padding:"18px"},800,"easeOutExpo",function(){a(this).addClass("activated").removeClass("deactivated").animate({padding:"18px"},600,"easeInQuad")}),this},deactivateLoader:function(b){return b.find(".overlay").css({backgroundColor:"rgba(0,0,0,0.1)"}),b.find(".loader").animate({top:"-50px",padding:"18px"},900,"easeOutQuint",function(){a(this).addClass("deactivated").removeClass("activated").animate({},500,"easeInQuad")}),this},dockCard:function(b){return g.hideDismissal(b),b.animate({"margin-bottom":"-500px",opacity:0},600,"easeOutSine",function(){a(this).addClass("fixed").addClass("docked")}),setTimeout(function(){g.revealCard(b)},5e3),this},revealCard:function(b){return b.animate({"margin-bottom":0,opacity:1,left:a(".wrapper").offset().left},900,"easeOutExpo",function(){a(this).removeClass("docked")}),this},restoreCard:function(a){a.removeClass("fixed").removeClass("docked").animate({"margin-bottom":0,opacity:.5,left:0,opacity:1})},nextCard:function(a){},configureCards:function(){a.each(a(".card"),function(b,c){a(c).find(".dismissal").find(".close-dismissal").on("click",function(){g.hideDismissal(a(c))}),a(c).find(".dismissal").find(".remove-ad").on("click",function(){g.nextCard(a(c))}),a(c).find(".close-card").on("click",function(){g.showDismissal(a(c))}),a.each(a(c).find(".dismissal ul").children(),function(b,c){a(c).on("click",function(){a(this).addClass("selected").siblings().removeClass("selected")})})})},createComponents:function(){g.PosterArrangement=d.createClass({displayName:"PosterArrangement",componentDidUpdate:function(){g.configureCards()},loadMoreCards:function(){for(var a=[],b=0;b<this.props.loadCount;b++)a.push({});newData=this.props.data.concat(a),this.setProps({data:newData})},render:function(){var a=this.props.data.map(function(a,b){return d.createElement(g.PosterCard,{key:b,dataOrientation:"left",dataSize:"normal"})});return d.createElement("div",{className:"card-arrangement",ref:"myArrangement","data-load-more":1==this.props.loadMore?!0:!1,"data-load-count":this.props.loadCount},a,d.createElement("div",{className:"cf"}),this.props.loadMore?d.createElement(g.ArrangementLoader,{onClick:this.loadMoreCards}):"")}}),g.ArrangementLoader=d.createClass({displayName:"ArrangementLoader",getInitialState:function(){return{load_more:!1}},LoadCards:function(b){a(this.getDOMNode()).find(".spinner").fadeIn(),this.setState({load_more:!0})},componentDidMount:function(){},componentDidUpdate:function(){1==this.state.load_more&&this.isMounted()&&(this.props.onClick(),this.setState({load_more:!1}),a(this.getDOMNode()).find(".spinner").hide())},render:function(){return d.createElement("div",{className:"load-more"},d.createElement("div",{className:"spinner left",style:{display:"none"}}),d.createElement("div",{id:"adPortal",className:"ad-portal"}),d.createElement("a",{className:"btn btn-small btn-pill right",style:{fontSize:"12px",margin:"18px 10px"},onClick:this.LoadCards},"LOAD MORE"))}}),g.PosterCard=d.createClass({displayName:"PosterCard",render:function(){return d.createElement("div",{className:""!=(this.props.dataOrientation||this.state.orientation)?"card-zone "+this.props.dataOrientation:"card-zone"},d.createElement("div",{className:(""!=(this.props.dataOrientation||this.state.orientation)?"card "+this.props.dataOrientation:"card")+" "+(""!=this.props.dataSize?this.props.dataSize:"normal"),"data-count":this.state.internal_count,"data-offset":this.state.internal_offset,"data-sp-count":this.state.sponsored_count,"data-sp-offset":this.state.sponsored_offset},d.createElement("span",{className:"card-icon restore-card"},d.createElement("i",{className:"oi","data-glyph":"arrow-circle-top"})),d.createElement("span",{className:"card-icon snooze-card"},d.createElement("i",{className:"oi","data-glyph":"timer"})),d.createElement(g.PosterCard.Close,null),d.createElement(g.PosterCard.Loader,null),d.createElement(g.PosterCard.Dismissal,null),d.createElement(g.PosterCard.Action,{data:this.state.data})))},getInitialState:function(){var a={data:[],internal_count:1,internal_offset:0,sponsored_count:1,sponsored_offset:0,orientation:"left",size:"normal"};return a},componentDidMount:function(){this.refreshCard(this)},componentDidUpdate:function(){},refreshCard:function(b){g.fetchCard(a(this.getDOMNode()),null,null,null,null,b)}}),g.PosterCard.Loader=d.createClass({displayName:"Loader",render:function(){return d.createElement("div",{className:"loader"},d.createElement("div",{className:"loading"},d.createElement("h2",null,"think bigger ..."),d.createElement("span",null),d.createElement("span",null),d.createElement("span",null),d.createElement("span",null),d.createElement("span",null),d.createElement("span",null),d.createElement("span",null)))}}),g.PosterCard.Dismissal=d.createClass({displayName:"Dismissal",render:function(){return d.createElement("div",{className:"dismissal off"},d.createElement("strong",null,"PLEASE CHOOSE A REASON ..."),d.createElement("ul",null,d.createElement("li",{className:"selected"},"This ad is misleading"),d.createElement("li",null,"I am unable to view it"),d.createElement("li",null,"Another reason here"),d.createElement("li",null,"TV killed the Radio")),d.createElement("a",{className:"btn btn-small btn-danger btn-primary remove-ad"},"REMOVE"),d.createElement("a",{className:"btn btn-small btn-success btn-secondary close-dismissal"},"CANCEL"))}}),g.PosterCard.Action=d.createClass({displayName:"Action",render:function(){return d.createElement("a",{href:this.props.data.url||"#",className:"cta"},d.createElement("div",{className:"image"},d.createElement("img",{className:"image",src:this.props.data.image||"http://placehold.it/320x240"})),d.createElement("div",{className:"headline"},this.props.data.headline),d.createElement("div",{className:"overlay"}))}}),g.PosterCard.Close=d.createClass({displayName:"Close",render:function(){return d.createElement("span",{className:"card-icon close-card"},"Ã—")}})},buildCard:function(b){""!=b&&d.render(d.createElement(g.PosterCard,{pollInterval:15e3,dataOrientation:a(b).data("orientation")||"left",dataSize:a(b).data("size")||"normal"}),b)},buildArrangement:function(b){if(""!=b){var c=parseInt(a(b).data("rows")),e=parseInt(a(b).data("cols")),f="true"==a(b).data("load-more")||1==a(b).data("load-more")?!0:!1;console.log(a(b).data("load-more"));for(var h=c*e,i=[],j=0;h>j;j++)i.push({});d.render(d.createElement(g.PosterArrangement,{data:i,loadMore:f,loadCount:e}),b)}}};g.init()}(jQuery,window,document,React);