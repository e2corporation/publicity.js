/*! Publicity 2015-06-05 */
!function(a,b,c,d,e,f){var g={init:function(){a("#footer").headroom(),a("#nav").headroom({offset:800}),e.initHighlightingOnLoad()}};a(c).ready(g.init)}(jQuery,window,document,Headroom,hljs),function(a,b,c,d,e){"use strict";var f={API:{endpoint:"https://trends.revcontent.com/api/v1/?",api_key:"fdbd849fb2b8c1c259585e7bcd6a09cc87e3e5b7",pub_id:10,widget_id:21,type:"json",domain:"powr.com"}},g={ReactCSSTransitionGroup:d.addons.CSSTransitionGroup,stack:[],emptyCard:{headline:"",url:"#",image:"http://placehold.it/320x240"},getStack:function(){return this.stack},foo:[],options:{cardClass:"publicity-card",gridClass:"publicity-arrangement"},internal_count:1,internal_offset:1,sponsored_count:1,sponsored_offset:1,init:function(){g.createComponents(),a.each(a(".publicity-card"),function(a,b){g.buildCard(b)}),g.buildArrangement(c.getElementById("example_grid")),g.buildArrangement(c.getElementById("example_grid_1x2"))},enableTouchEventHandling:function(){d.initializeTouchEvents(!0)},fetchCard:function(b,c,d,e,h,i){if(b)var j=b;else var j=a(".card:first");c||(c=parseInt(j.attr("data-offset"))),d||(d=parseInt(j.attr("data-count"))),e||(e=parseInt(j.attr("data-sp-offset"))),h||(h=parseInt(j.attr("data-sp-count"))),g.internal_count=c||1,g.internal_offset++,g.sponsored_count=h||1,g.sponsored_offset++;a.ajax({url:f.API.endpoint,type:"get",dataType:f.API.type,cache:!1,data:{api_key:f.API.api_key,pub_id:f.API.pub_id,widget_id:f.API.widget_id,type:f.API.type,domain:f.API.domain,sponsored_count:g.sponsored_count,sponsored_offset:g.sponsored_offset},beforeSend:function(){g.hideDismissal(j),g.activateLoader(j)},success:function(b){if(console.log(b),b.length>0&&(g.stack.push(b[0]),"object"==typeof i&&i.isMounted())){if(i.setState({internal_count:g.internal_count,internal_offset:g.internal_offset,sponsored_count:g.sponsored_count,sponsored_offset:g.sponsored_offset}),"object"==typeof i.props.myArrangement){var c=i.props.myArrangement.props.data,d=i.props.myKey;isNaN(d)&&(d=c.length),c[d]=g.stack[g.stack.length-1],i.props.myArrangement.setProps({data:c})}else console.log(i),i.setProps({data:g.stack[g.stack.length-1]});a(i.getDOMNode()).find(".loader").hasClass("deactivated")||g.deactivateLoader(a(i.getDOMNode()))}return b.length>0?b:void 0},error:function(a){}})},advanceCounters:function(a,b,c,d){g.internal_count=a||1,g.internal_offset++,g.sponsored_count=d||1,g.sponsored_offset++},retrieveAds:function(b,c,d,e,h,i){a.ajax({url:f.API.endpoint,type:"get",dataType:f.API.type,cache:!1,data:{api_key:f.API.api_key,pub_id:f.API.pub_id,widget_id:f.API.widget_id,type:f.API.type,domain:f.API.domain,sponsored_count:b||g.sponsored_count,sponsored_offset:c||g.sponsored_offset},beforeSend:function(){},success:function(a){a.length>0&&(g.stack.concat(a),console.log(typeof i,i),"function"==typeof i&&(g.advanceCounters(c,b,c,b),i(a,e,d,c,h)))},error:function(){}})},showDismissal:function(b){return b.find(".dismissal").animate({"margin-top":0},600,"easeOutQuart",function(){a(this).addClass("on").removeClass("off")}),this},hideDismissal:function(b){return b.find(".dismissal").animate({"margin-top":"-600px"},500,"easeInQuart",function(){a(this).removeClass("on").addClass("off")}),this},activateLoader:function(b){return b.find(".overlay").css({backgroundColor:"rgba(0,0,0,0.8)"}),g.dropHeadline(b),b.find(".loader").transition({x:0,y:0,opacity:1},100,"easeOutQuad",function(){a(this).addClass("activated").removeClass("deactivated")}),this},deactivateLoader:function(a){return a.find(".loader").delay(660).transition({x:700,y:-700},660,"easeInQuad",function(){var b=this;a.find(".overlay").animate({backgroundColor:"rgba(0,0,0,0.1)"},1e3,"easeInOutQuint",function(){b.addClass("deactivated").removeClass("activated"),g.raiseHeadline(a)})}),this},raiseHeadline:function(a){return a.find(".headline").hide().css({"z-index":161,opacity:0,bottom:0}).show().animate({opacity:1},327,"easeOutExpo"),this},dropHeadline:function(a){return a.find(".headline").css({opacity:0,"z-index":150,bottom:"-50px"}).animate({},240,"easeInQuad"),this},dockCard:function(b){return g.hideDismissal(b),b.animate({"margin-bottom":"-500px",opacity:0},600,"easeOutSine",function(){a(this).addClass("fixed").addClass("docked")}),setTimeout(function(){g.revealCard(b)},5e3),this},revealCard:function(b){return b.animate({"margin-bottom":0,opacity:1,left:a(".wrapper").offset().left},900,"easeOutExpo",function(){a(this).removeClass("docked")}),this},restoreCard:function(a){return a.removeClass("fixed").removeClass("docked").animate({"margin-bottom":0,opacity:.5,left:0}),this},nextCard:function(a){},switchOverlay:function(b,c){switch(b){case"on":c.find(".overlay").stop(!0,!0).animate({opacity:1},850,"easeOutBack",function(){a(this).removeClass("hover")});break;case"off":c.find(".overlay").stop(!0,!0).animate({opacity:.05},1050,"easeOutSine",function(){a(this).addClass("hover")})}return this},configureCards:function(b){var c=[];c=a(b?b:".card"),a.each(c,function(b,c){a(c).on("mouseenter",function(){g.switchOverlay("off",a(this))}),a(c).on("mouseleave",function(){g.switchOverlay("on",a(this))}),a(c).find(".dismissal").find(".close-dismissal").on("click",function(){g.hideDismissal(a(c))}),a(c).find(".dismissal").find(".remove-ad").on("click",function(){g.nextCard(a(c))}),a(c).find(".close-card").on("click",function(){g.showDismissal(a(c))}),a.each(a(c).find(".dismissal ul").children(),function(b,c){a(c).on("click",function(){a(this).addClass("selected").siblings().removeClass("selected")})}),a("")})},createComponents:function(){g.PosterArrangement=d.createClass({displayName:"PosterArrangement",getInitialState:function(){return{revised_stack:[]}},componentDidMount:function(){this.isMounted()},componentDidUpdate:function(){a(this.getDOMNode()).find(".spinner").css({marginTop:0,opacity:1}).delay(2e3).animate({marginTop:"10px",opacity:0},450,"easeOutExpo",function(){}),a(this.getDOMNode()).find(".load-btn").removeClass("disabled").delay(1e3).animate({opacity:1},450,"easeInQuad",function(){})},componentWillUpdate:function(){a(this.getDOMNode()).find(".load-btn").addClass("disabled").animate({opacity:0},250,"easeOutQuad",function(){}),a(this.getDOMNode()).find(".spinner").css({marginTop:"10px",opacity:0}).show().animate({marginTop:0,opacity:1},650,"easeOutExpo",function(){})},loadMoreCards:function(){var b=this.props.data,c=this;a.ajax({url:f.API.endpoint,type:"get",dataType:f.API.type,cache:!1,data:{api_key:f.API.api_key,pub_id:f.API.pub_id,widget_id:f.API.widget_id,type:f.API.type,domain:f.API.domain,sponsored_count:this.props.loadCount||g.sponsored_count,sponsored_offset:parseInt(a(this.getDOMNode()).find(".card-zone:last").find(".card").attr("data-offset"))||0},beforeSend:function(){},success:function(a){c.setProps({data:b.concat(a)})}})},render:function(){var a=this,b=this.props.data.map(function(b,c){return d.createElement(g.PosterCard,{key:c,data:b,dataOrientation:"left",dataSize:"normal",dataOffset:c,dataAutofill:"false",myKey:c,myArrangement:a,ref:"myCard"})});return this.state.revised_stack.length>0&&(alert("Revising Stack!"),b=this.state.revised_stack),d.createElement("div",{className:"card-arrangement",ref:"myArrangement","data-load-more":1==this.props.loadMore?!0:!1,"data-load-count":this.props.loadCount,"data-load-offset":this.props.loadOffset},b,d.createElement("div",{className:"cf"}),this.props.loadMore?d.createElement(g.ArrangementLoader,{onClick:this.loadMoreCards}):"")}}),g.ArrangementLoader=d.createClass({displayName:"ArrangementLoader",getInitialState:function(){return{load_more:!1}},LoadCards:function(a){this.setState({load_more:!0})},componentDidMount:function(){},componentDidUpdate:function(){1==this.state.load_more&&this.isMounted()&&(this.props.onClick(),this.setState({load_more:!1}),a(this.getDOMNode()).find(".spinner").hide())},render:function(){return d.createElement("div",{className:"load-more"},d.createElement("div",{className:"spinner left",style:{display:"none"}},"LOADING"),d.createElement("div",{id:"adPortal",className:"ad-portal"}),d.createElement("a",{className:"load-btn btn btn-small btn-pill right",style:{fontSize:"12px",margin:"18px 10px"},onClick:this.LoadCards},"LOAD MORE"),d.createElement("div",{className:"cf"}))}}),g.PosterCardComponent=g.PosterCard=d.createClass({displayName:"PosterCard",render:function(){return d.createElement("div",{ref:"myPosterCard",className:""!=(this.props.dataOrientation||this.state.orientation)?"card-zone "+this.props.dataOrientation:"card-zone"},d.createElement("div",{className:(""!=(this.props.dataOrientation||this.state.orientation)?"card "+this.props.dataOrientation:"card")+" "+(""!=this.props.dataSize?this.props.dataSize:"normal"),"data-key":this.props.key,"data-count":this.state.internal_count,"data-offset":this.props.dataOffset||this.state.internal_offset,"data-autofill":this.props.dataAutofill||this.state.autofill,"data-sp-count":this.state.sponsored_count,"data-sp-offset":this.state.sponsored_offset},d.createElement("span",{className:"card-icon restore-card"},d.createElement("i",{className:"oi","data-glyph":"arrow-circle-top"})),d.createElement("span",{className:"card-icon snooze-card"},d.createElement("i",{className:"oi","data-glyph":"timer"})),d.createElement(g.PosterCard.Close,null),d.createElement(g.PosterCard.Loader,null),d.createElement(g.PosterCard.Dismissal,{cardComponent:this}),d.createElement(g.PosterCard.Action,{data:this.props.data,creative:this.props.dataCreative})))},getInitialState:function(){var a={data:{headline:"Headline",url:"#",image:"http://placehold.it/320x240"},internal_count:1,internal_offset:0,sponsored_count:1,sponsored_offset:0,orientation:"left",size:"normal",autofill:!1};return a},componentWillReceiveProps:function(){},componentWillMount:function(){},componentDidMount:function(){!0===this.props.autoPoll&&this.props.pollInterval>=15e3&&setInterval(this.refreshCard,this.props.pollInterval),g.activateLoader(a(this.getDOMNode()));var b=this;b.isMounted()&&(!0===this.props.dataAutofill||"true"==this.props.dataAutofill?this.refreshCard(this):a(b.getDOMNode()).find(".loader").hasClass("deactivated")||g.deactivateLoader(a(b.getDOMNode())),g.configureCards(a(b.getDOMNode())))},componentWillUpdate:function(){},componentDidUpdate:function(){g.deactivateLoader(a(this.getDOMNode()))},refreshCard:function(b){b||(b=this),g.fetchCard(a(this.getDOMNode()),null,null,null,null,b)}}),g.PosterCard.Loader=d.createClass({displayName:"Loader",render:function(){return d.createElement("div",{className:"loader"},d.createElement("div",{className:"loading"},d.createElement("h2",null,"think bigger ..."),d.createElement("span",null),d.createElement("span",null),d.createElement("span",null),d.createElement("span",null),d.createElement("span",null),d.createElement("span",null),d.createElement("span",null)))}}),g.PosterCard.Dismissal=d.createClass({displayName:"Dismissal",getInitialState:function(){return{dismissal_title:"Select a Reason",dismissed:!1,buttons:{remove:{label:"REMOVE"},cancel:{label:"CANCEL"}}}},dismissCard:function(b){this.setState({dismissed:!0}),g.fetchCard(a(this.getDOMNode()).closest(".card"),null,null,null,null,this.props.cardComponent)},render:function(){return d.createElement("div",{className:"dismissal off"},d.createElement("strong",{className:"dismissal-title"},this.state.dismissal_title),d.createElement("ul",null,d.createElement("li",{className:"selected"},"This ad is misleading"),d.createElement("li",null,"I am unable to view it"),d.createElement("li",null,"Another reason here"),d.createElement("li",null,"TV killed the Radio")),d.createElement("a",{className:"btn btn-small btn-danger btn-primary remove-ad",onClick:this.dismissCard},this.state.buttons.remove.label),d.createElement("a",{className:"btn btn-small btn-success btn-secondary close-dismissal"},this.state.buttons.cancel.label))}}),g.PosterCard.Action=d.createClass({displayName:"Action",render:function(){return d.createElement("a",{href:this.props.data.url!=e?this.props.data.url:this.state.data.url,className:"cta"},d.createElement("div",{className:"image"},d.createElement("img",{className:"image",src:""!=this.props.creative&&this.props.creative!=e?this.props.creative:this.props.data.image!=e?this.props.data.image:this.state.data.image})),d.createElement("div",{className:"headline"},this.props.data.headline!=e?this.props.data.headline:this.state.data.headline),d.createElement("div",{className:"overlay"}))}}),g.PosterCard.Close=d.createClass({displayName:"Close",render:function(){return d.createElement("span",{className:"card-icon close-card"},"×")}})},buildCard:function(a){""!=a&&g.renderCard(a)},renderCard:function(b){var c=g.emptyCard;d.render(d.createElement(g.PosterCard,{pollInterval:parseInt(a(b).attr("data-poll"))||15e3,autoPoll:a(b).attr("data-poll")==e||isNaN(a(b).attr("data-poll"))?!1:!0,dataAutofill:a(b).attr("data-autofill")||"false",dataOrientation:a(b).attr("data-orientation")||"left",data:c,dataCreative:a(b).attr("data-creative")||!1,dataSize:a(b).attr("data-size")||"normal"}),b)},buildArrangement:function(b){if(""!=b){var c=parseInt(a(b).data("rows")),d=parseInt(a(b).data("cols")),e="true"==a(b).data("load-more")||1==a(b).data("load-more")?!0:!1,f=c*d;g.retrieveAds(f,0,d,e,b,g.renderArrangement)}},renderArrangement:function(a,b,c,e,f){d.render(d.createElement(g.PosterArrangement,{data:a,loadMore:b,loadCount:a.length/c*c,loadOffset:e}),f)}};g.init()}(jQuery,window,document,React);